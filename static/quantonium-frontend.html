<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quantonium OS Cloud Runtime</title>
  <style>
    body {
      font-family: Segoe UI, sans-serif;
      background: #111;
      color: #eee;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 800px;
      margin: auto;
      padding: 40px 20px;
    }
    h1 {
      text-align: center;
      font-size: 24px;
      margin-bottom: 20px;
    }
    .tabs {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
    }
    .tab {
      cursor: pointer;
      padding: 10px 20px;
      background: #222;
      border: 1px solid #333;
      border-radius: 4px;
      color: #aaa;
    }
    .tab.active {
      background: #28a;
      color: white;
    }
    .panel {
      display: none;
      background: #1a1a1a;
      border: 1px solid #333;
      border-radius: 4px;
      padding: 20px;
    }
    .panel.active {
      display: block;
    }
    textarea, input {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #444;
      border-radius: 4px;
      background: #222;
      color: white;
    }
    button {
      padding: 10px 20px;
      background: #28a;
      border: none;
      border-radius: 4px;
      color: white;
      cursor: pointer;
    }
    .result, .error {
      margin-top: 15px;
      white-space: pre-wrap;
      background: #222;
      padding: 10px;
      border-radius: 4px;
    }
    .error {
      color: #f55;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üß† Quantonium OS Cloud Runtime</h1>
    <div class="tabs">
      <div class="tab active" data-panel="encrypt">Encrypt</div>
      <div class="tab" data-panel="decrypt">Decrypt</div>
      <div class="tab" data-panel="rft">RFT</div>
      <div class="tab" data-panel="entropy">Entropy</div>
      <div class="tab" data-panel="container">Container</div>
    </div>

    <div class="panel active" id="encrypt">
      <h2>Encryption</h2>
      <textarea id="encrypt-plaintext" placeholder="Enter plaintext..."></textarea>
      <input id="encrypt-key" placeholder="Enter key..." />
      <button onclick="doEncrypt()">Encrypt</button>
      <div class="result" id="encrypt-result"></div>
      <div class="error" id="encrypt-error"></div>
    </div>
    
    <div class="panel" id="decrypt">
      <h2>Decryption</h2>
      <textarea id="decrypt-ciphertext" placeholder="Enter ciphertext (base64 encoded)..."></textarea>
      <input id="decrypt-key" placeholder="Enter key..." />
      <button onclick="doDecrypt()">Decrypt</button>
      <div class="result" id="decrypt-result"></div>
      <div class="error" id="decrypt-error"></div>
    </div>

    <div class="panel" id="rft">
      <h2>Resonance Fourier Transform</h2>
      <input id="rft-waveform" placeholder="0.1,0.5,0.9,0.5,0.1,0.5,0.9" />
      <button onclick="doRFT()">Run RFT</button>
      <div class="result" id="rft-result"></div>
      <div class="error" id="rft-error"></div>
    </div>

    <div class="panel" id="entropy">
      <h2>Entropy Generator</h2>
      <input type="number" id="entropy-amount" value="32" min="1" max="1024" />
      <button onclick="doEntropy()">Generate</button>
      <div class="result" id="entropy-result"></div>
      <div class="error" id="entropy-error"></div>
    </div>

    <div class="panel" id="container">
      <h2>Container Unlock</h2>
      <input id="container-waveform" placeholder="0.3,0.7,0.2" />
      <input id="container-hash" placeholder="Verification hash..." />
      <button onclick="doUnlock()">Unlock</button>
      <div class="result" id="container-result"></div>
      <div class="error" id="container-error"></div>
    </div>
  </div>

  <script>
    // Use the API's server URL when embedded in Squarespace
    const API_URL = "https://quantum-shield-luisminier79.replit.app";
    const API_KEY = "default_dev_key";

    const headers = {
      "Content-Type": "application/json",
      "x-api-key": API_KEY
    };

    const tabs = document.querySelectorAll(".tab");
    const panels = document.querySelectorAll(".panel");
    tabs.forEach(tab => {
      tab.onclick = () => {
        tabs.forEach(t => t.classList.remove("active"));
        panels.forEach(p => p.classList.remove("active"));
        tab.classList.add("active");
        document.getElementById(tab.dataset.panel).classList.add("active");
      };
    });

    async function apiCall(endpoint, data) {
      const res = await fetch(`${API_URL}/api${endpoint}`, {
        method: "POST",
        headers,
        body: JSON.stringify(data)
      });
      if (!res.ok) throw new Error(`Error ${res.status}`);
      return await res.json();
    }

    async function doEncrypt() {
      const pt = document.getElementById("encrypt-plaintext").value;
      const key = document.getElementById("encrypt-key").value;
      const out = document.getElementById("encrypt-result");
      const err = document.getElementById("encrypt-error");
      out.textContent = "";
      err.textContent = "";
      try {
        const res = await apiCall("/encrypt", { plaintext: pt, key });
        out.textContent = res.ciphertext;
      } catch (e) {
        err.textContent = e.message;
      }
    }
    
    async function doDecrypt() {
      const ct = document.getElementById("decrypt-ciphertext").value;
      const key = document.getElementById("decrypt-key").value;
      const out = document.getElementById("decrypt-result");
      const err = document.getElementById("decrypt-error");
      out.textContent = "";
      err.textContent = "";
      try {
        const res = await apiCall("/decrypt", { ciphertext: ct, key });
        out.textContent = res.plaintext;
      } catch (e) {
        err.textContent = e.message;
      }
    }

    async function doRFT() {
      const str = document.getElementById("rft-waveform").value;
      const out = document.getElementById("rft-result");
      const err = document.getElementById("rft-error");
      out.textContent = "";
      err.textContent = "";
      try {
        const waveform = str.split(",").map(s => parseFloat(s.trim()));
        const res = await apiCall("/simulate/rft", { waveform });
        out.textContent = JSON.stringify(res.frequencies, null, 2);
      } catch (e) {
        err.textContent = e.message;
      }
    }

    async function doEntropy() {
      const amount = parseInt(document.getElementById("entropy-amount").value);
      const out = document.getElementById("entropy-result");
      const err = document.getElementById("entropy-error");
      out.textContent = "";
      err.textContent = "";
      try {
        const res = await apiCall("/entropy/sample", { amount });
        out.textContent = res.entropy;
      } catch (e) {
        err.textContent = e.message;
      }
    }

    async function doUnlock() {
      const str = document.getElementById("container-waveform").value;
      const hash = document.getElementById("container-hash").value;
      const out = document.getElementById("container-result");
      const err = document.getElementById("container-error");
      out.textContent = "";
      err.textContent = "";
      try {
        const waveform = str.split(",").map(s => parseFloat(s.trim()));
        const res = await apiCall("/container/unlock", { waveform, hash });
        out.textContent = res.unlocked ? "‚úÖ Container Unlocked" : "‚ùå Access Denied";
      } catch (e) {
        err.textContent = e.message;
      }
    }
  </script>
</body>
</html>
