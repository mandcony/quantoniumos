# Core Theorems of the Closed-Form Φ-RFT

Let \(F\) be the unitary DFT matrix with entries \(F_{jk} = n^{-1/2}\,\omega^{jk}\), \(\omega=e^{-2\pi i / n}\) (NumPy `norm="ortho"`).

Define diagonal phase matrices
\[
[C_\sigma]_{kk} = \exp\!\Big(i\pi\sigma \frac{k^2}{n}\Big), \qquad
[D_\phi]_{kk}   = \exp\!\big(2\pi i\,\beta\,\{k/\phi\}\big),
\]
where \(\phi=\tfrac{1+\sqrt 5}{2}\) (golden ratio) and \(\{\cdot\}\) is fractional part.  
Set \(\Psi = D_\phi\,C_\sigma\,F\).

---

## Theorem 1 — Unitary Factorization
Since \(D_\phi^\dagger=D_\phi^{-1}\), \(C_\sigma^\dagger=C_\sigma^{-1}\), and \(F^\dagger F=I\),
\[
\Psi^\dagger\Psi = F^\dagger C_\sigma^\dagger D_\phi^\dagger D_\phi C_\sigma F = F^\dagger F = I.
\]
Thus \(\Psi\) is unitary. A vector multiply uses **\(\mathcal O(n\log n)\)** operations (one FFT + two diagonal multiplies).

**Inverse:** \(\Psi^{-1} = F^\dagger C_\sigma^\dagger D_\phi^\dagger\).  
In code (NumPy): `ifft(conj(C)*conj(D)*y, norm="ortho")`.

---

## Theorem 2 — Exact Diagonalization of a Commutative Algebra
Define Φ-RFT twisted convolution
\[
(x \star_{\phi,\sigma} h) \;=\; \Psi^\dagger\,\mathrm{diag}(\Psi h)\,\Psi x.
\]
Then
\[
\Psi(x \star_{\phi,\sigma} h) \;=\; (\Psi x)\odot(\Psi h).
\]
Hence \(\Psi\) simultaneously diagonalizes the algebra \(\mathcal A=\{\,\Psi^\dagger \mathrm{diag}(g) \Psi : g\in\mathbb C^n\,\}\), which is commutative and associative.

---

## Theorem 3 — Non-Quadraticity of Golden-Ratio Phase (Non-LCT Property)
The diagonal phase operator \(D_\phi\) with entries \(\exp(i \theta_k)\) where \(\theta_k = 2\pi\beta \{k/\phi\}\) cannot be generated by a Linear Canonical Transform (LCT) or Fractional Fourier Transform (FrFT) for any \(\beta \notin \mathbb{Z}\).

**Proof:**
The class of LCT/FrFT operators is generated by quadratic phase modulations (chirps), scalings, and Fourier rotations. Any diagonal operator in this group must have a phase function \(Q(k)\) that is quadratic in \(k\) (modulo \(2\pi\)), i.e., \(Q(k) \equiv Ak^2 + Bk + C \pmod{2\pi}\).
We show that \(\theta_k = 2\pi\beta \{k/\phi\}\) is not quadratic modulo \(2\pi\) for \(\beta \notin \mathbb{Z}\).

Assume for contradiction that \(\beta \{k/\phi\} \equiv Ak^2 + Bk + C \pmod 1\).
Apply the second difference operator \(\Delta^2_k\) (discrete derivative):
\[
\Delta^2 (\beta \{k/\phi\}) \equiv \Delta^2 (Ak^2 + Bk + C) \equiv 2A \pmod 1.
\]
The RHS is constant modulo 1.
Analyze the LHS using the identity \(\{x\} = x - \lfloor x \rfloor\):
\[
\Delta \{k/\phi\} = \frac{1}{\phi} - \left(\lfloor \frac{k+1}{\phi} \rfloor - \lfloor \frac{k}{\phi} \rfloor\right) = \frac{1}{\phi} - d_k,
\]
where \(d_k \in \{0, 1\}\) is the Sturmian sequence associated with the irrational slope \(1/\phi\).
\[
\Delta^2 \{k/\phi\} = -(d_{k+1} - d_k).
\]
Thus, the condition for quadraticity becomes:
\[
-\beta(d_{k+1} - d_k) \equiv 2A \pmod 1.
\]
Since \(1/\phi\) is irrational, the sequence \(d_k\) is aperiodic, and the difference \(d_{k+1} - d_k\) takes values in \(\{-1, 0, 1\}\).
1. When \(d_{k+1} - d_k = 0\), we must have \(0 \equiv 2A \pmod 1\).
2. When \(d_{k+1} - d_k = 1\), we must have \(-\beta \equiv 2A \pmod 1\).
3. When \(d_{k+1} - d_k = -1\), we must have \(\beta \equiv 2A \pmod 1\).

From (1), \(2A\) must be an integer. From (2), \(-\beta\) must be congruent to an integer.
This implies \(\beta \in \mathbb{Z}\).
**Conclusion:** If \(\beta\) is not an integer, \(\theta_k\) is not quadratic modulo \(2\pi\). Therefore, \(D_\phi\) lies outside the LCT/FrFT class, providing a distinct "Golden-Ratio Phase" modulation that cannot be replicated by standard time-frequency shears.

---

## Practical Tests (implemented in `tests/rft/`)
- **Round-trip:** \(\|x - \Psi^{-1}\Psi x\|/\|x\| \approx 10^{-16}\).
- **Commutator:** \(\|h_1\star(h_2\star x)-(h_2\star(h_1\star x))\|/\|x\| \approx 10^{-15}\).
- **Non-equivalence:** large RMS residual to quadratic phase; low max DFT correlation; high entropy of \(\Psi^\dagger F\) columns.

---

### Historical Note
An earlier formulation built \(\Psi\) via QR orthonormalization of a phase kernel. See Appendix A for details and equivalence assumptions.

---

## Appendix A — Alternative Kernel-Based Formulation (Historical)
**Definition (Kernel Form).** Let
\[
K_{ij} = g_{ij}\,\exp\big(2\pi i\,\beta\, \varphi_i\, \varphi_j\big),
\]
with amplitude envelope \(g_{ij}\) and index embedding \(\varphi_k\) (e.g. \(\varphi_k = \{k/\phi\}\)). The transform was originally taken as
\[
\Psi = \mathrm{orth}(K)\quad (\text{e.g. QR, first \(n\) columns}).
\]

**Equivalence to Closed-Form.** Assume:
1. (Approximate separability) \(g_{ij} \approx g_i h_j\) with low-rank residual.
2. (Golden-ratio embedding) \(\varphi_i = \{i/\phi\}\) up to bounded perturbation \(|\delta_i| \leq \epsilon\).
3. (Singular alignment) Leading left/right singular vectors of \(K\) align (componentwise phase) with \(D_\phi\) and \(C_\sigma F\) columns.
Then after column normalization and global phase adjustment,
\[
\mathrm{orth}(K) \approx D_\phi C_\sigma F,
\]
with empirical Frobenius relative residual \(r_n = \|K - D_\phi C_\sigma F\|_F/\|K\|_F\) observed \(<10^{-3}\) for tested \(n\in[128,512]\). Formal bounds pending.

**Disclaimer (Empirical Status).** The above alignment and residual are currently empirical; a proof requires bounding SVD perturbations under near-separable modulation and low-discrepancy index embeddings.

**Practical Guidance.** For implementation and benchmarking use the closed-form \(\Psi = D_\phi C_\sigma F\): it avoids QR (\(\mathcal O(n^3)\) preprocessing), is numerically stable, and gives immediate \(\mathcal O(n\log n)\) apply complexity. The kernel view remains valuable for provenance and potential extensions (e.g. alternative envelopes \(g_{ij}\)).

**Future Work.** Provide explicit perturbation lemma: if \(\|g_{ij} - g_i h_j\|_F \leq \eta\) and \(|\delta_i| \leq \epsilon\), then derive \(r_n = \mathcal O(\eta + \epsilon)\). Document envelope choices and their spectral effects.

---
 
