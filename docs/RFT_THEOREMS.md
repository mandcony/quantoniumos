# Core Theorems of the Closed-Form Φ-RFT

Let \(F\) be the unitary DFT matrix with entries \(F_{jk} = n^{-1/2}\,\omega^{jk}\), \(\omega=e^{-2\pi i / n}\) (NumPy `norm="ortho"`).

Define diagonal phase matrices
\[
[C_\sigma]_{kk} = \exp\!\Big(i\pi\sigma \frac{k^2}{n}\Big), \qquad
[D_\phi]_{kk}   = \exp\!\big(2\pi i\,\beta\,\{k/\phi\}\big),
\]
where \(\phi=\tfrac{1+\sqrt 5}{2}\) (golden ratio) and \(\{\cdot\}\) is fractional part.  
Set \(\Psi = D_\phi\,C_\sigma\,F\).

---

## Theorem 1 — Unitary Factorization
Since \(D_\phi^\dagger=D_\phi^{-1}\), \(C_\sigma^\dagger=C_\sigma^{-1}\), and \(F^\dagger F=I\),
\[
\Psi^\dagger\Psi = F^\dagger C_\sigma^\dagger D_\phi^\dagger D_\phi C_\sigma F = F^\dagger F = I.
\]
Thus \(\Psi\) is unitary. A vector multiply uses **\(\mathcal O(n\log n)\)** operations (one FFT + two diagonal multiplies).

**Inverse:** \(\Psi^{-1} = F^\dagger C_\sigma^\dagger D_\phi^\dagger\).  
In code (NumPy): `ifft(conj(C)*conj(D)*y, norm="ortho")`.

---

## Theorem 2 — Exact Diagonalization of a Commutative Algebra
Define Φ-RFT twisted convolution
\[
(x \star_{\phi,\sigma} h) \;=\; \Psi^\dagger\,\mathrm{diag}(\Psi h)\,\Psi x.
\]
Then
\[
\Psi(x \star_{\phi,\sigma} h) \;=\; (\Psi x)\odot(\Psi h).
\]
Hence \(\Psi\) simultaneously diagonalizes the algebra \(\mathcal A=\{\,\Psi^\dagger \mathrm{diag}(g) \Psi : g\in\mathbb C^n\,\}\), which is commutative and associative.

---

## Lemma — Non-Quadratic Golden-Ratio Phase
Let \(\theta_k = 2\pi\beta \{k/\phi\}\) (mod \(2\pi\)). The best least-squares quadratic fit
\(\theta_k \approx a k^2 + b k + c\) has residual RMS bounded away from 0 (empirically \(\approx 0.3\)–\(0.5\) rad for \(n=128\ldots512\)), so \(D_\phi\) is not a quadratic-phase operator. Therefore \(\Psi\) is **not** an LCT/FrFT (which are generated by quadratic phases up to unitary sandwiches).

---

## Practical Tests (implemented in `tests/rft/`)
- **Round-trip:** \(\|x - \Psi^{-1}\Psi x\|/\|x\| \approx 10^{-16}\).
- **Commutator:** \(\|h_1\star(h_2\star x)-(h_2\star(h_1\star x))\|/\|x\| \approx 10^{-15}\).
- **Non-equivalence:** large RMS residual to quadratic phase; low max DFT correlation; high entropy of \(\Psi^\dagger F\) columns.
 
